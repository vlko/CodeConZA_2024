<section class="slide" id="cover">
    <h1>PostgreSQL ako dokumentov√° datab√°za<br>(aj v prehliadaƒçi)</h1>
    <img class="place l b" width="200em" height="200em" src="/images/vlko-linkedin.png" />
    <footer class="place b r">
        Mari√°n Vlƒç√°k aka vlko, FinStat s.r.o<br>
        <a href="https://linkedin.com/in/vlko">&#64;vlkodotnet</a>
    </footer>
</section>

<section class="slide">
    <h1>Kto je vlko?</h1>
    <ul>
        <li>Mari√°n Vlƒç√°k</li>
        <li>naivn√Ω amat√©rsky blogger a technologick√Ω nad≈°enec</li>
        <li>CTO vo FinStat</li>
        <li>komunitne zaanga≈æovan√Ω: WebUP, vyvojari.dev</li>
    </ul>
    <img class="place r" style="padding-bottom:100px" width="200em" height="200em" src="/images/webup.png" />
    <img class="place r b" width="200em" height="200em" src="/images/vyvojari.png" />
</section>

<section class="slide">
    <h1>ƒåo sa dozviete</h1>
    <ul>
        <li>√öplne z√°klady a motiv√°ciu pre predn√°≈°ku</li>
        <li>ƒåo je PostgreSQL JSONB a ako sa to queryuje</li>
        <li>Ako to vylep≈°i≈•</li>
        <li>Ostatn√∫ vatu na 45 min√∫t</li>
    </ul>
</section>

<section class="slide">
    <div class="shout shrink">
        <img  width="400em" height="400em" src="/images/register_speach.jpg" />
    </div>
</section>

<section class="slide">
    <div class="shout shrink">
        <img  width="400em" height="400em" src="/images/panic.webp" />
    </div>
</section>

<section class="slide">
    <h1>Vsuvka ƒç. 1</h1>
    <ul>
        <li>0 % AI, 5 % k√≥du, 95 % libiek</li>
        <li><s>C# WASM Blazor</s></li>
        <li>Angular</li>
        <li>Shower Presentation Template</li>
        <li>Linka na zdroj√°k a≈æ na konci predn√°≈°ky</li>
    </ul>
    <img class="place r b" width="200em" height="200em" src="/images/shower.png" />
</section>

<section class="slide">
    <h1>ƒåo je to PostgreSQL?</h1>
    <ul>
        <li>objektovo-relaƒçn√Ω datab√°zov√Ω syst√©m</li>
        <li>licencia BSD</li>
        <li>Postgres v√Ωvoj zaƒçal roku 1982, prototyp 1988, skonƒçil 1993, potom komunitn√Ω v√Ωvoj a pridan√≠m SQL => PostgreSQL</li>
    </ul>
</section>

<section class="slide">
    <h1>ƒåo s√∫ to dokumentov√© datab√°zy?</h1>
    <ul>
        <li>Na rozdiel od RDBMS <small>(relational database management system)</small> ukladaj√∫ objekty bez sch√©my</li>
        <li>funkcionalita: prida≈•/zmeni≈•/maza≈• podƒæa kƒæ√∫ƒça</li>
        <li>d√°ta ukladan√© ako XML, JSON, bin√°rne, YAML</li>
    </ul>
</section>

<section class="slide">
    <h1>‚ûï a ‚ûñ dokumentov√Ωch DB</h1>
    <ul>
        <li>‚ûï Schema-less</li>
        <li>‚ûï R√Ωchle</li>
        <li>‚ûï/‚ûñ ≈†k√°lovateƒæn√©</li>
        <li>‚ûñ filter => index</li>
        <li>‚ûñ design/developers</li>
    </ul>
</section>

<section class="slide">
    <h1>FinStat a dokumentov√© DB</h1>
    <img class="place r b" width="200em" height="200em" src="/images/RavenDB.png" />
    <ul>
        <li>Prim√°rne RavenDB</li>
        <li>Od zaƒçiatku postaven√© "dokumentovou mentalitou"</li>
        <li>"In production" aj in√© DB (SQLite, MSSql, PostgreSQL)</li>
    </ul>
</section>

<section class="slide">
    <h2 class="shout shrink">Preƒço sa teda FinStat v≈ïta v PostgreSQL?</h2>
</section>

<section class="slide">
    <h2 class="shout shrink">$$ MONEY $$</h2>
</section>

<section class="slide">
    <h1>Vieme to lep≈°ie/lacnej≈°ie?</h1>
    <ul>
        <li>2019 research: alternat√≠va RavenDB pre nov√Ω EU projekt</li>
        <li>CosmosDB</li>
        <li>RavenDB</li>
        <li>ElasticSearch</li>
    </ul>
</section>

<section class="slide">
    <h1>Following Idea</h1>
    <ul>
        <li>2019 research: persistecia d√°t projektu meta.finstat</li>
        <li>Schema-less data s typov√Ωm wrapperom</li>
        <li>CosmosDB</li>
        <li>PostgreSQL</li>
    </ul>
</section>

<section class="slide">
    <h2 class="shout shrink">PostgreSQL<br> JSONB<br>üèÜ</h2>
</section>


<section class="slide">
    <h1>PostgreSQL JSON podpora</h1>
    <ul>
        <li>Store type: json, jsonb</li>
        <li>Index: GIN (jdoc) vs (jdoc jsonb_path_ops)</li>
        <li>Query: jsonpath, jsonb_to_record</li>
        <li>A hlavne <strong>"schema free"</strong></li>
    </ul>
</section>

<section class="slide">
    <h2 class="shout shrink">DEMO</h2>
</section>

<section class="slide">
    <h1>Vsuvka ƒç. 2 - PGLite</h1>
    <ul>
        <li>WASM PostgreSQL</li>
        <li>Vo va≈°om prehliadaƒçi</li>
        <li><img  width="600em" src="/images/jsuchal_why.png" /></li>
    </ul>
    <img class="place r b" width="200em" height="200em" src="/images/pglite.png" />
</section>

<section class="slide"  [style.overflow]="'auto'">
    <div class="place t"><h2>Table design</h2></div>
    <div class="place t r simple-line" >
        <button (click)="generateDefinition()">Definition</button><br>
        <button (click)="generateQuery('insert into books (title, data)
values (
  \'vlko a postgresql\', 
  \'{
    &quot;room&quot;:&quot;Scheidt &amp; Bachmann STAGE&quot;,
    &quot;people&quot;: 10
  }\'
)')">Single item</button><br>
        <button (click)="generateBooksInsert()">Data</button>
    </div>
    <app-postgresql-window [query]="query"></app-postgresql-window>
</section>

<section class="slide"  [style.overflow]="'auto'">
    <div class="place t"><h2>Table querying</h2></div>
    <div class="place t r simple-line" >
        <button (click)="generateQuery('select count(*) from books')">Count</button><br>
        <button (click)="generateQuery('select title,\n  data->\'categs\' as categs, data->\'pageCount\'\n  from books')">Simple query</button><br>
        <button (click)="generateQuery('select title, d.* from books,
  LATERAL jsonb_to_record(data)
  d(categs text[], &quot;pageCount&quot; integer, isbn text)')">Select query</button><br>
        <button (click)="generateQuery('select title, d.* from books,  LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)
  where \'Open Source\' = any (categs)')">Categ filter</button><br>
        <button (click)="generateQuery('select title, d.* from books,  LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)
  where &quot;pageCount&quot; &gt; 10
  order by &quot;pageCount&quot; desc')">Count filter</button><br>
        <button (click)="generateMoreBooksInsert()">More Data</button><br>
    </div>
    <app-postgresql-window [query]="query"></app-postgresql-window>
</section>

<section class="slide"  [style.overflow]="'auto'">
    <div class="place t"><h2>Efficient table querying</h2></div>
    <div class="place t r simple-line" >
        <button (click)="generateQuery('CREATE INDEX JsonDataFieldsIndex\n  ON books\n  USING gin (Data);\nCREATE INDEX JsonDataIndex\n  ON books\n  USING gin (Data jsonb_path_ops);')">Create Index</button><br>
        <button (click)="generateQuery('select title,
  data->\'room\' as room, data->\'people\' as people from books
  where data ? \'room\'')">Field filter</button><br>
        <button (click)="generateQuery('select title, d.* from books, LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)
  where data @&gt; \'{&quot;categs&quot;: [&quot;PowerBuilder&quot;]}\'')">Categ filter</button><br>
        <button (click)="generateQuery('select title, d.* from books, LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)
  where data @&gt; \'{&quot;pageCount&quot;: 0}\'')">Pages filter</button><br>
        <button (click)="generateQuery('select title, d.* from books, LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)
  order by data->\'pageCount\' desc')">Order by filter</button><br>
    </div>
    <app-postgresql-window [query]="query"></app-postgresql-window>
</section>

<section class="slide"  [style.overflow]="'auto'">
    <div class="place t"><h2>Materialized view</h2></div>
    <div class="place t r simple-line" >
        <button (click)="generateDefinition()">Definition</button><br>
        <button (click)="generateBooksInsert()">Data</button><br>
        <button (click)="generateQuery('CREATE MATERIALIZED VIEW books_data AS
  SELECT id, d.*
  FROM books, LATERAL jsonb_to_record(data) d(categs text[], &quot;pageCount&quot; integer, isbn text)')">Data view</button><br>
        <button (click)="generateQuery('select * from books_data')">select data</button><br>
        <button (click)="generateQuery('CREATE MATERIALIZED VIEW categ_groups AS
  SELECT 
        unnest(d.categs) categ,
        count(id) categItems
  FROM books, LATERAL jsonb_to_record(data) d(categs text[])
  GROUP BY categ')">Agg. view</button><br>
        <button (click)="generateQuery('select * from categ_groups')">select agg.</button><br>
        <button (click)="generateMoreBooksInsert()">More Data</button><br>
        <button (click)="generateQuery('REFRESH MATERIALIZED VIEW books_data;\nREFRESH MATERIALIZED VIEW categ_groups;')">Refresh</button><br>
    </div>
    <app-postgresql-window [query]="query"></app-postgresql-window>
</section>


<section class="slide">
    <h2 class="shout shrink">Toƒæko odo m≈àa.<br>In≈°pirujte sa.</h2>
</section>

<section class="slide">
    <h1>Odkazy</h1>
    <img class="place" width="300em" height="300em" src="/images/src_github.png" />
    <img class="place r b" width="200em" height="200em" src="/images/pglite.png" />
    <img class="place l b" width="200em" height="200em" src="/images/vlko_bluesky.png" />
</section>